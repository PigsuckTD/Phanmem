<UserControl x:Class="QuanLyNhaHang.View.DatBan"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:vm="clr-namespace:QuanLyNhaHang.ViewModel"
             mc:Ignorable="d"
             Background="#111111">

    <UserControl.DataContext>
        <vm:DatBanViewModel />
    </UserControl.DataContext>

    <UserControl.Resources>
        <!-- FIX popup lịch tối màu -->
        <SolidColorBrush x:Key="MaterialDesignPaper" Color="#1E1E1E"/>
        <SolidColorBrush x:Key="MaterialDesignBody" Color="White"/>
        <SolidColorBrush x:Key="MaterialDesignBodyLight" Color="#DDDDDD"/>
        <SolidColorBrush x:Key="PrimaryHueMidBrush" Color="#FF8C00"/>
        <SolidColorBrush x:Key="MaterialDesignBackground" Color="#111111"/>

        <Style TargetType="Calendar">
            <Setter Property="Background" Value="#1E1E1E"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>
        <Style TargetType="CalendarDayButton">
            <Setter Property="Background" Value="#FF8C00"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>
    </UserControl.Resources>

    <Grid>
        <!-- Thanh cam trên cùng -->
        <Rectangle Height="4" VerticalAlignment="Top" Fill="#FFA500"/>

        <!-- Khung chính -->
        <Border Margin="40,30,40,40" Background="#1E1E1E" CornerRadius="8">
            <Border.Effect>
                <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.6" Color="#000"/>
            </Border.Effect>

            <Grid Margin="10">
                <!-- Tiêu đề -->
                <TextBlock Text="Đặt bàn"
                           FontSize="36"
                           FontWeight="SemiBold"
                           Foreground="#A8F5C8"
                           Margin="40 30 0 0"/>

                <!-- Form -->
                <Border Background="#111111" Margin="30 90 30 30" Padding="30 25" CornerRadius="8">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>

                            <!-- Thông tin của bạn -->
                            <TextBlock Text="Thông tin của bạn"
                                       Foreground="#FFA500"
                                       FontWeight="SemiBold"
                                       FontSize="17"
                                       Margin="0 0 0 15"/>

                            <!-- Tên -->
                            <Border Background="#252525" Height="50" Margin="0 0 0 12" CornerRadius="10">
                                <TextBox Padding="16 0" Foreground="White" Background="Transparent" BorderThickness="0"
                                         FontSize="15" VerticalAlignment="Center"
                                         materialDesign:HintAssist.Hint="Tên của bạn"
                                         materialDesign:HintAssist.Foreground="#888888"
                                         Text="{Binding TenKhach, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            </Border>

                            <!-- SĐT -->
                            <Border Background="#252525" Height="50" Margin="0 0 0 25" CornerRadius="10">
                                <TextBox Padding="16 0" Foreground="White" Background="Transparent" BorderThickness="0"
                                         FontSize="15" VerticalAlignment="Center"
                                         materialDesign:HintAssist.Hint="Số điện thoại"
                                         materialDesign:HintAssist.Foreground="#888888"
                                         Text="{Binding SDT, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            </Border>

                            <!-- Chọn bàn -->
                            <TextBlock Text="Chọn bàn"
                                       Foreground="#FFA500"
                                       FontWeight="SemiBold"
                                       FontSize="17"
                                       Margin="0 0 0 15"/>

                            <!-- SỐ LƯỢNG - NGÀY - GIỜ -->
                            <StackPanel Orientation="Horizontal" Margin="0 0 0 25">

                                <!-- Số lượng khách - ĐÃ XÓA RenderTransform LẠ Ở NÚT + -->
                                <StackPanel Width="130" Margin="0 0 20 0">
                                    <TextBlock Text="Số lượng khách" Foreground="#CCCCCC" FontSize="13" Margin="0 0 0 8"/>
                                    <Border Background="#222222" Height="50" CornerRadius="10">
                                        <DockPanel LastChildFill="False" VerticalAlignment="Center">
                                            <Button Content="−" Width="40" FontSize="20" Foreground="White"
                                                    Background="Transparent" BorderThickness="0"
                                                    Click="GiamSoNguoi_Click"
                                                    Cursor="Hand"/>
                                            <TextBlock Text="{Binding SoNguoi}" Foreground="White" FontSize="18" FontWeight="SemiBold"
                                                       Width="40" TextAlignment="Center" VerticalAlignment="Center"/>
                                            <Button Content="+" Width="48" FontSize="20" Foreground="White"
                                                    Background="Transparent" BorderThickness="0"
                                                    Click="TangSoNguoi_Click"
                                                    Cursor="Hand"/>
                                        </DockPanel>
                                    </Border>
                                </StackPanel>

                                <!-- Ngày đặt -->
                                <StackPanel Width="210" Margin="0 0 20 0">
                                    <TextBlock Text="Ngày đặt" Foreground="#CCCCCC" FontSize="13" Margin="0 0 0 8"/>
                                    <Border Background="#222222" Height="50" CornerRadius="10">
                                        <DatePicker SelectedDate="{Binding NgayDat, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                    Foreground="White"
                                                    Background="Transparent"
                                                    BorderThickness="0"
                                                    Padding="16 0 40 0"
                                                    FontSize="12"
                                                    VerticalContentAlignment="Center"
                                                    Style="{StaticResource MaterialDesignOutlinedDatePicker}"/>
                                    </Border>
                                </StackPanel>

                                <!-- Giờ đến -->
                                <StackPanel Width="170">
                                    <TextBlock Text="Giờ đến" Foreground="#CCCCCC" FontSize="13" Margin="0 0 0 8"/>
                                    <Border Background="#222222" Height="50" CornerRadius="10">
                                        <ComboBox ItemsSource="{Binding TimeOptions}"
                                                  SelectedItem="{Binding GioDat, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                  Foreground="White"
                                                  Background="Transparent"
                                                  BorderThickness="0"
                                                  Padding="16 0"
                                                  FontSize="12"
                                                  materialDesign:HintAssist.Hint="Chọn giờ"
                                                  materialDesign:HintAssist.Foreground="#888888"
                                                  Style="{StaticResource MaterialDesignOutlinedComboBox}" Height="30"/>
                                    </Border>
                                </StackPanel>
                            </StackPanel>
                            <!-- COMBOBOX CHỌN BÀN - ĐÃ XÓA RenderTransformOrigin lạ -->
                            <Border Background="#252525" Height="50" Margin="0 0 0 25" CornerRadius="10">
                                <ComboBox ItemsSource="{Binding DanhSachBan}"
              SelectedItem="{Binding BanDuocChon, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
              Padding="16 0"
              Foreground="White"
              Background="Transparent"
              BorderThickness="0"
              FontSize="15"
              materialDesign:HintAssist.Hint="Chọn số bàn (Đỏ = Có khách, Xám = Đã đặt)"
              materialDesign:HintAssist.Foreground="#888888"
              materialDesign:HintAssist.IsFloating="True" Height="50">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding HienThi}"
                           Foreground="{Binding MauChu}"
                           FontWeight="{Binding DoDam}"/>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                    <ComboBox.ItemContainerStyle>
                                        <Style TargetType="ComboBoxItem">
                                            <Setter Property="IsEnabled" Value="True"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding TrangThai}" Value="Đã đặt">
                                                    <Setter Property="IsEnabled" Value="False"/>
                                                    <Setter Property="Foreground" Value="Gray"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding TrangThai}" Value="Có khách">
                                                    <Setter Property="IsEnabled" Value="False"/>
                                                    <Setter Property="Foreground" Value="Red"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ComboBox.ItemContainerStyle>
                                </ComboBox>
                            </Border>


                            <!-- Ưu đãi -->
                            <Border Background="#252525" Height="50" Margin="0 0 0 25" CornerRadius="10">
                                <ComboBox Padding="16 0" Foreground="#66FFAA" Background="Transparent" BorderThickness="0"
                                          ItemsSource="{Binding UuDaiList}"
                                          SelectedItem="{Binding UuDai, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                          materialDesign:HintAssist.Hint="Chọn ưu đãi">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <materialDesign:PackIcon Kind="StarCircle" Foreground="#66FFAA" Margin="0 0 10 0" VerticalAlignment="Center"/>
                                                <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </Border>

                            <!-- Ghi chú - ĐỔI MÀU DỄ ĐỌC HƠN -->
                            <Border Background="#2A2A2A" Margin="0 0 0 30" Padding="16" CornerRadius="12">
                                <TextBox TextWrapping="Wrap" AcceptsReturn="True" Foreground="White"
                                         Background="Transparent" BorderThickness="0" FontSize="15"
                                         Height="80"
                                         materialDesign:HintAssist.Hint="Ghi chú thêm (nếu có)"
                                         materialDesign:HintAssist.Foreground="#888888"
                                         Text="{Binding GhiChu, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            </Border>

                            <!-- Nút bấm -->
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0 20 0 0">
                                <!-- Nút HỦY -->
                                <Button Content="HỦY" Width="120" Height="50" Margin="0 0 15 0"
                                        Background="#FF8C00"
                                        Foreground="White" 
                                        FontSize="15" FontWeight="SemiBold"
                                        Cursor="Hand"
                                        Click="BtnHuyDatBan_Click">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="BorderBrush" Value="#666"/>
                                            <Setter Property="BorderThickness" Value="2"/>
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border Background="{TemplateBinding Background}"
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                CornerRadius="25">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#333333"/>
                                                    <Setter Property="BorderBrush" Value="#999"/>
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="True">
                                                    <Setter Property="Background" Value="#222222"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>

                                <!-- Button Đặt bàn -->
                                <Button Content="ĐẶT BÀN NGAY" Width="200" Height="50"
                                        Background="#FF8C00"
                                        BorderThickness="0"
                                        Foreground="White"
                                        FontSize="16"
                                        FontWeight="SemiBold"
                                        Cursor="Hand"
                                        Command="{Binding DatBanCommand}">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border Background="{TemplateBinding Background}"
                                                                CornerRadius="25"
                                                                BorderThickness="0">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#FF9D1A"/>
                                                </Trigger>
                                                <Trigger Property="IsEnabled" Value="False">
                                                    <Setter Property="Background" Value="#555555"/>
                                                    <Setter Property="Foreground" Value="#999999"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </StackPanel>

                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </Grid>
        </Border>
    </Grid>
</UserControl>